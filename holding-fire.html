<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../polymerfire/firebase-document.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-button/paper-button.html">
<!--
`holding-fire`

Example:
```
<firebase-app
    name="demo"
    api-key="API_KEY"
    auth-domain="AUTH_DOMAIN"
    database-url="DATABASE_URL"
></firebase-app>
<holding-fire 
    app-name="demo"
    path="users/"
    logo="images/logo.png"
    text="Website coming soon! Subscribe to find out when we launch!"
    email="hello@convoo.me"
></holding-fire>
```

### Styling

Style the element with CSS as you would a normal DOM element. 

The following custom properties and mixins are available for styling:

| Custom property | Description | Default |
| --- | --- | --- |
| `--holding-fire-input-color` | The color for the input | `white` |
| `--holding-fire-background` | Mixin for the background | `{}` |
| `--holding-fire-overlay` | Mixin for the overlay  | `{}` |
| `--holding-fire-container` | Mixin ofr the container | `{}` |
| `--holding-fire-logo` | Mixin for the logo | `{}` |
| `--holding-fire-email-text` | Mixin for the email text | `{}` |
| `--holding-fire-email-text` | Mixin for the email text | `{}` |
| `--holding-fire-welcome-text` | Mixin for the welcome text | `{}` |
| `--holding-fire-input` | Mixin for the input | `{}` |
| `--holding-fire-subscribe-button` | Mixin for the subscribe button | `{}` |
| `--holding-fire-twitter-button` | Mixin for the twitter button | `{}` |
| `---holding-fire-subscribe-container` | Mixin for the subscribe container| `{}` |
| `--holding-fire-twitter-container` | Mixin for the Twitter container | `{}` |
| `--holding-fire-show-thankyou` | Mixin for revealing the thank you container | `{}` |

@demo demo/index.html 
-->

<dom-module id="holding-fire">
  <template>
      
    <style>
    :host {
        display: block;
        position: absolute;
        left: 0px;
        bottom: 0px;
        right: 0px;
        top: 0px;
        @apply(--layout-horizontal);
        @apply(--layout-center); 
    }
    .background{     
        position: absolute;
        left: 0px;
        bottom: 0px;
        right: 0px;
        top: 0px;
        -webkit-background-size: cover;
 +      -moz-background-size: cover;
 +      -o-background-size: cover;
 +      background-size: cover;
        background-color: black;
        @apply(--holding-fire-background);
    }
    .overlay{
        position: absolute;
        left: 0px;
        bottom: 0px;
        right: 0px;
        top: 0px;
        z-index: 200;
        @apply(--holding-fire-overlay);
    }
    .container{
        z-index: 400;
        padding: 20px;
        max-width: 1117px;
        margin: auto;
        opacity: 1;
        border-radius: 2px;
        text-align: center;
        background-image: -webkit-linear-gradient(#F3F2F2 35%, #ECEBEB 100%);
        background-image: -o-linear-gradient(#F3F2F2 35%, #ECEBEB 100%);
        background-image: linear-gradient(#F3F2F2 35%, #ECEBEB 100%);
        @apply(--holding-fire-container); 
    }
    .inner-container{
        @apply(--layout-horizontal);
        @apply(--layout-center); 
        @apply(--layout-wrap);
    }
    .logo{
        width: 150px;
        height: 27px;
        padding-bottom: 70px;
        margin: auto;
        @apply(--holding-fire-logo); 
    }
    .content{
        font-family: Georgia, Times, 'Times New Roman', serif; 
        font-size: 1em;
        color: #000000;
        letter-spacing: 0.32px;
        line-height: 1.5em;
        text-align: left;
        vertical-align: top;
        margin: auto;
        padding-bottom: 20px;
    }

        @media (min-width: 1117px) {
            .container{
                min-width: 1037px;
                padding: 40px;
            }
            .content{
                max-width: 600px;
                margin-top: 0px;
                padding-bottom: 0px;
            }
            .subscribe-container{
                max-width: 360px;
                margin-left:40px;
                margin-bottom: 30px;
            }
        }

    .subscribe-container{
        width: 100%;
        min-width: 280px;
        text-align: left;
        background: #FFFFFF;
        box-shadow: 0 1px 0 0 rgba(0,0,0,0.13);
        border-radius: 2px;
        height: 370px;
    }
    .subscribe-title{
        padding:20px;
        padding-left:30px;
        font-size: 14px;
        color: #757C84;
        letter-spacing: 0.91px;
        border-bottom: 1px solid #F0EEEE;
        @apply(--holding-fire-subscrbe-title); 
    }
    .welcome-text{
        z-index: 400;
        @apply(--holding-fire-welcome-text); 
    }
    .email a{
        opacity: 0.32;
        font-family: Roboto-Regular;
        font-size: 11px;
        color: #000000;
        letter-spacing: 0.2px;
        text-decoration:none;
        @apply(--holding-fire-email-text); 
    }

    paper-button.subscribe {
        z-index: 400;
        width: 100%;
        height: 44px;
        background: #FFFFFF;
        border: 1px solid #6092E0;
        border-radius: 2px;
        margin-top: 20px;
        margin-bottom: 20px;
        font-family: Roboto-Bold;
        font-size: 14px;
        color: #6092E0;
        letter-spacing: 0.05px;
        @apply(--holding-fire-subscribe-button); 
    }

    a.button {
        text-decoration: none;
    }

    paper-button.twitter {
        z-index: 400;
        margin: auto;
        width: 90%;
        margin-left: 20px;
        background-color:  #58aae8;
        color: white;
        height: 40px;
        font-weight: bold;
        font-size: 14px;
        margin-top: 20px;
        margin-bottom: 20px;
        text-transform: capitalize;
        @apply(--holding-fire-twitter-button); 
    }
    paper-input.custom {
        --paper-input-container-color: var(--holding-fire-input-color, gray);
        --paper-input-container-focus-color: var(--holding-fire-input-color, gray);
        --paper-input-container-invalid-color: var(--holding-fire-input-color, gray);
        --paper-input-container-input-color: var(--holding-fire-input-color, gray);
        z-index: 400;
        text-align: left;
        @apply(--holding-fire-input); 
    }
    .form{
        padding-top: 20px;
        padding-left: 35px;
        padding-right: 40px;
        padding-bottom: 5px;
    }

    .show-thanks{
        height: 100%;
        @apply(--holding-fire-show-thankyou); 
    }

    .twitter-form {
        height: 100%;
        padding: 20px;
        @apply(--layout-vertical);
        @apply(--layout-center);
    }

    .twitter-form a {
        width: 100%;
    }

    .cant-select {
        -webkit-touch-callout: none; 
        -webkit-user-select: none; 
        -khtml-user-select: none; 
        -moz-user-select: none; 
        -ms-user-select: none; 
        user-select: none; 
    }
    @keyframes fade {
        0% {
            opacity: 0;
        }
        100% {
            opacity: 1;
        }
    }
    @keyframes zoom {
        0% {
            transform: scale(1);
        }
        100% {
            transform: scale(1.1);
        }
    }
    </style>

    <firebase-document
        id="doc"
        app-name="[[appName]]"
        path="[[path]]"
        data="{{data}}">
    </firebase-document>

    <div class="background"></div>
    <div class="overlay"></div>
    <div class="container">
        <img src="[[logo]]" class="logo" sizing="contain" alt="[[alt]]]">
        <div class="inner-container">

            <div class="content"> <content></content></div>
         
            <div class="subscribe-container">
                
                <template is="dom-if" if="{{!subscribed}}" class="hidden"> 
                        <div class="subscribe-title">[[subHeader]]</div> 
                        <div class="form">
                            <paper-input label="Name" class="custom" id="name" required error-message="Please enter your name" on-keydown="_catchEnter"></paper-input></br>    
                            <paper-input label="Email address" class="custom" id="email" type="email" required error-message="Please enter a valid email address" on-keydown="_catchEnter"></paper-input></br>            
                            <paper-button class="subscribe" on-tap="subscribe">[[subButton]]</paper-button>
                            <p class="email"><a href="mailto:[[email]]">[[email]]</a></p>
                        </div>
                </template>


                <template is="dom-if" if="{{subscribed}}"> 
                    <div hidden="{{!subscribed}}" class="show-thanks">
                        <div class="subscribe-title">[[thanksHeader]]</div>
                        <div class="twitter-form">
                            <p>[[thanks]]</p>
                            <template is="dom-if" if="{{twitter}}">
                                <a href$="https://twitter.com/[[twitter]]" target="_blank" tabindex="-1" class="button">
                                    <paper-button raised class="twitter">
                                        <svg viewBox="0 0 20.34 16.17" style="height:15px;fill:#FFF; padding-left: 10px; padding-right: 10px">
                                        <path class="515a544b-2ee6-4052-8329-f9002443fb0f" d="M7,16.61A11.39,11.39,0,0,0,18.43,5.14q0-.26,0-0.52a8.2,8.2,0,0,0,2-2.09,8,8,0,0,1-2.31.63A4,4,0,0,0,19.89.94a8.08,8.08,0,0,1-2.56,1,4,4,0,0,0-6.87,3.68A11.44,11.44,0,0,1,2.15,1.38,4,4,0,0,0,3.4,6.76a4,4,0,0,1-1.83-.5s0,0,0,.05a4,4,0,0,0,3.23,4A4,4,0,0,1,3,10.33a4,4,0,0,0,3.77,2.8,8.09,8.09,0,0,1-5,1.73,8.19,8.19,0,0,1-1-.06A11.41,11.41,0,0,0,7,16.61" transform="translate(-0.36 -0.55)"/>
                                        </svg>Follow us on Twitter
                                    </paper-button>
                                </a>
                            </template>
                        </div>
                    </div>
                </template>


            </div>
        </div>

    </div>
</template>

  <script>
    Polymer({
    is: 'holding-fire',
    properties: {
        /**
        * Link to the image file for the logo
        *
        * @type {String}
        */
        logo: {
          type: String,
        },
        /**
        * Text to be displayed below the logo
        *
        * @type {String}
        */
        text: {
          type: String,
        },
        /**
        * Text to be displayed to thank the user
        *
        * @type {String}
        */
        thanks: {
          type: String,
        },
        /** 
        * Header text for thanks section 
        * 
        * @type {String} 
        */ 
        thanksHeader: { 
            type: String, 
            value: "THANKS FOR SUBSCRIBING" 
        }, 
        /**
        * Email to be displayed below the subscription form 
        *
        * @type {String}
        */
        email: {
          type: String,
        },
        /**
        * The name of the firebase app
        *
        * @type {String}
        */
        appName: {
          type: String,
        },
        /**
        * The storage path for the subscription emails 
        *
        * @type {String}
        */
        path: {
          type: String,
        },
        /**
        * Indicates if the user has subscribed 
        *
        * @type {Boolean}
        */
        subscribed: {
            type: Boolean,
            value: false,
        },
        /**
        * Alt text for the logo
        *
        * @type {String}
        */
        alt: {
            type: String,
        },
        /** 
        * Header text for subscription section 
        * 
        * @type {String} 
        */ 
        subHeader: { 
            type: String, 
            value: "BE THE FIRST TO KNOW" 
        }, 
        /** 
        * Button text for subscription section 
        * 
        * @type {String} 
        */ 
        subButton: { 
            type: String, 
            value: "Subscribe" 
        }, 
      },

    subscribe: function(){
        var date = new Date();
        var epoch = date.getTime();
        n = this.$$("#name").validate()
        e = this.$$("#email").validate()
        if( n && e ){
            this.$.doc.ref.push({name: this.$$("#name").value, email: this.$$("#email").value, date: epoch});  
            this.subscribed = true;
        }
    },

    _catchEnter: function(e){
        if (e.keyCode ===13){
            this.subscribe();
        }
    }

    });
  </script>
</dom-module>
